install.packages(sp)
install.packages("sp")
library(sp)
install.packages("spacetime")
?STIDF
library(spacetime)
install.packages("xts")
library(spacetime)
install.packages("spacetime")
install.packages("spacetime")
library(spacetime)
install.packages("xts")
install.packages("spacetime",TRUE)
24*60*4
myfdf[myfdf[,1]<10,]
p <- ggplot(trip_times, aes( time, trip_length, color=group ))
p + geom_point()
trips_joined[trips_joined$trip_length < 600,]
trips_joined <- trips_joined[trips_joined$trip_length < 600,]
trips_joined$trip_length <- difftime( strptime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trips_joined$trip_start_experiment <- difftime ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$questionnaire1, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trips_joined$trip_stop_experiment <- difftime( strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trips_joined$questionnaire1), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_start = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_start_experiment, trips_joined$trip_length)
names(trip_start) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_start$time_type <- "start"
trip_stop = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_stop_experiment, trips_joined$trip_length)
names(trip_stop) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_stop$time_type <- "stop"
trip_times <- rbind(trip_start, trip_stop)
trips_joined$day_of_week_trip = weekdays(as.Date(trips_joined$trip_start), abbreviate = TRUE)
wilcox.test(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length),
as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined$trip_length))
p <- ggplot(trip_times[], aes( time, trip_length, color=group ))
p + geom_point()
trips_joined <- trips_joined[trips_joined$trip_length < 240,]
trips_joined <- trips_joined[trips_joined$trip_length < 180,]
trips_joined$trip_length <- difftime( strptime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trips_joined$trip_start_experiment <- difftime ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$questionnaire1, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trips_joined$trip_stop_experiment <- difftime( strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trips_joined$questionnaire1), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_start = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_start_experiment, trips_joined$trip_length)
names(trip_start) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_start$time_type <- "start"
trip_stop = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_stop_experiment, trips_joined$trip_length)
names(trip_stop) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_stop$time_type <- "stop"
trip_times <- rbind(trip_start, trip_stop)
trips_joined$day_of_week_trip = weekdays(as.Date(trips_joined$trip_start), abbreviate = TRUE)
x_label <- "Day of the campaign"
y_label <- "Number of trips"
shapiro.test(trips_joined$hour_day)
ks.test(trips_joined$hour_day)
qqnorm(trips_joined$hour_day)
wilcox.test(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length),
as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined$trip_length))
View(trips_joined)
trips_joined$trip_length
trips_joined[trips_joined$trip_length < 1,]
trips_joined[trips_joined$trip_length < 1,]&trip_length
trips_joined[trips_joined$trip_length < 1,]$trip_length
trips_joined <- trips_joined[trips_joined$trip_length < 180 & trips_joined$trip_length >.5,]
trips_joined[trips_joined$trip_length < 1,]$trip_length
trips_joined$trip_length <- difftime( strptime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trips_joined$trip_start_experiment <- difftime ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$questionnaire1, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trips_joined$trip_stop_experiment <- difftime( strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trips_joined$questionnaire1), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_start = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_start_experiment, trips_joined$trip_length)
names(trip_start) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_start$time_type <- "start"
trip_stop = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_stop_experiment, trips_joined$trip_length)
names(trip_stop) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_stop$time_type <- "stop"
trip_times <- rbind(trip_start, trip_stop)
trips_joined$day_of_week_trip = weekdays(as.Date(trips_joined$trip_start), abbreviate = TRUE)
x_label <- "Day of the campaign"
y_label <- "Number of trips"
shapiro.test(trips_joined$hour_day)
ks.test(trips_joined$hour_day)
qqnorm(trips_joined$hour_day)
wilcox.test(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length),
as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined$trip_length))
trips_joined <- trips_joined[trips_joined$trip_length < 180 & trips_joined$trip_length >1,]
trips_joined[trips_joined$trip_length < 1,]$trip_length
trips_joined$trip_length <- difftime( strptime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trips_joined$trip_start_experiment <- difftime ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$questionnaire1, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trips_joined$trip_stop_experiment <- difftime( strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trips_joined$questionnaire1), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_start = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_start_experiment, trips_joined$trip_length)
names(trip_start) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_start$time_type <- "start"
trip_stop = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_stop_experiment, trips_joined$trip_length)
names(trip_stop) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_stop$time_type <- "stop"
trip_times <- rbind(trip_start, trip_stop)
trips_joined$day_of_week_trip = weekdays(as.Date(trips_joined$trip_start), abbreviate = TRUE)
x_label <- "Day of the campaign"
y_label <- "Number of trips"
shapiro.test(trips_joined$hour_day)
ks.test(trips_joined$hour_day)
qqnorm(trips_joined$hour_day)
wilcox.test(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length),
as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined$trip_length))
p <- ggplot(trip_times[], aes( time, trip_length, color=group ))
p + geom_point()
p <- ggplot(trip_times[], aes( time, trip_length, color=group ))
p + geom_point()
source("scripts/setup.R")
library(ggplot2)
require(lubridate)
trips_joined$day_time <-  format ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trips_joined$day_time <- strptime(trips_joined$day_time, format = "%H:%M:%OS")
trips_joined$hour_day <- hour(trips_joined$day_time) + minute(trips_joined$day_time) / 60.0
trips_joined <- trips_joined[trips_joined$trip_length < 180 & trips_joined$trip_length >.5,]
trips_joined$trip_length <- difftime( strptime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trips_joined$trip_start_experiment <- difftime ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$questionnaire1, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trips_joined$trip_stop_experiment <- difftime( strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trips_joined$questionnaire1), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_start = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_start_experiment, trips_joined$trip_length)
names(trip_start) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_start$time_type <- "start"
trip_stop = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_stop_experiment, trips_joined$trip_length)
names(trip_stop) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_stop$time_type <- "stop"
trip_times <- rbind(trip_start, trip_stop)
trips_joined$day_of_week_trip = weekdays(as.Date(trips_joined$trip_start), abbreviate = TRUE)
x_label <- "Day of the campaign"
y_label <- "Number of trips"
shapiro.test(trips_joined$hour_day)
ks.test(trips_joined$hour_day)
qqnorm(trips_joined$hour_day)
wilcox.test(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length),
as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined$trip_length))
ggplot(data=trips_joined, aes(trip_length)) +
geom_freqpoly() +
xlim(1, 120) + xlab(x_label) + ylab(y_label) +
theme_bw() + facet_grid(group ~ .)
ggplot(data=trips_joined, aes(hour_day) ) +
geom_freqpoly(bins = 24) +
xlim(0, 23) +
theme_bw() + facet_grid(city ~ .)
trip_times$trip_lenght
p <- ggplot(trip_times, aes( time, hour(trip_times$day_time), color=group ))
p + geom_line()  + theme(legend.position = "false")
p + geom_point() + theme(legend.position = "bottom") + facet_grid(city ~ .)
p <- ggplot(trip_times[], aes( time, trip_length, color=group ))
p + geom_point()
hist(as.numeric(trip_times$trip_length),breaks = 300)
myfdf <- data.frame(trips_joined$trip_length, trips_joined$trip_start, trips_joined$trip_stop)
names(myfdf) <- c
myfdf <- myfdf[]
head(trip_times$day_time)
source("scripts/setup.R")
source("scripts/setup.R")
library(ggplot2)
require(lubridate)
trips_joined$day_time <-  format ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trips_joined$day_time <- strptime(trips_joined$day_time, format = "%H:%M:%OS")
trips_joined$hour_day <- hour(trips_joined$day_time) + minute(trips_joined$day_time) / 60.0
trips_joined <- trips_joined[trips_joined$trip_length < 180 & trips_joined$trip_length >.5,]
trips_joined$trip_length <- difftime( strptime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trips_joined$trip_start_experiment <- difftime ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$questionnaire1, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trips_joined$trip_stop_experiment <- difftime( strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trips_joined$questionnaire1), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_start = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_start_experiment, trips_joined$trip_length)
names(trip_start) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_start$time_type <- "start"
trip_start$time_type
trip_start
trips_joined$city
trips_joined <- merge(trips_joined, table_answers)
table_participants = read.csv('data/Cyclist_Experiment.csv')
table_trips = read.csv('data/Cyclist_Trip.csv', sep = '\t')
table_answers = read.csv('data/Questionnaire_Answers.csv')
table_answers$group <- "none"
table_answers[which(table_answers$competition_1 >= -3),]$group <- "Competition"
table_answers[which(table_answers$collaboration_1 >= -3),]$group <- "Collaboration"
trips_joined <- merge(table_participants,table_trips)
trips_joined <- merge(trips_joined, table_answers)
View(trips_joined)
trips_joined$day_time <-  format ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trips_joined
trips_joined$day_time
trips_joined$day_time <- strptime(trips_joined$day_time, format = "%H:%M:%OS")
trips_joined$day_time
trips_joined$day_time <- strptime(trips_joined$day_time, format = "%H:%M:%OS")
trips_joined$hour_day <- hour(trips_joined$day_time) + minute(trips_joined$day_time) / 60.0
trips_joined$hour_day
trips_joined$day_time
hour(trips_joined$day_time)
source("scripts/setup.R")
library(ggplot2)
require(lubridate)
trips_joined$day_time <-  format ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trips_joined$day_time
strptime(trips_joined$day_time, format = "%H:%M:%OS")
hour(trips_joined$day_time)
strptime(trips_joined$day_time, format = "%H:%M:%OS")
trips_joined$day_time <- strptime(trips_joined$day_time, format = "%H:%M:%OS")
trips_joined$day_time
hour(trips_joined$day_time)
minute(trips_joined$day_time)
minute(trips_joined$day_time) / 60.0
hour(trips_joined$day_time) + minute(trips_joined$day_time) / 60.0
trips_joined$hour_day <- hour(trips_joined$day_time) + minute(trips_joined$day_time) / 60.0
trips_joined$hour_day
trips_joined$hour_day
trips_joined$trip_length
hour(trips_joined$day_time) + minute(trips_joined$day_time) / 60.0
trips_joined$hour_day <- hour(trips_joined$day_time) + minute(trips_joined$day_time) / 60.0
difftime( strptime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trips_joined$trip_length <- difftime( strptime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
source('~/Documents/Experiment Data/MS_Analysis/scripts/B_Engagement_with_cycling_trips.R', echo=TRUE)
trips_joined$trip_start_experiment <- difftime ( strptime(trips_joined$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trips_joined$questionnaire1, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trips_joined$trip_stop_experiment <- difftime( strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trips_joined$questionnaire1), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
hist(trips_joined$trip_length)
hist(as.numeric(trips_joined$trip_length))
ggplot(trips_joined, aes(x=trip_length)) + geom_histogram(color="black", fill="white")
trips_joined$trip_length
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram(color="black", fill="white", binwidth=5)
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram(color="black", fill="white", binwidth=1)
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram(color="black", fill="white", binwidth=0.5)
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram( fill="white", binwidth=0.5)
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram( binwidth=0.5)
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram( binwidth=0.5) +
theme_bw()
trips_valid <- trips_joined[trips_joined$trip_length < 60 & trips_joined$trip_length >.5,]
ggplot(trips_valid, aes(x=trip_length)) +
geom_histogram( binwidth=0.5) +
theme_bw()
theme_bw()
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram( binwidth=0.5) +
geom_density(alpha=.2, fill="#FF6666") +
theme_bw()
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram( binwidth=0.5) +
geom_density() +
theme_bw()
ggplot(trips_valid, aes(x=trip_length)) +
geom_histogram( binwidth=0.5) +
geom_density() +
theme_bw()
ggplot(trips_valid, aes(x=trip_length)) +
geom_histogram( binwidth=1) +
geom_density() +
theme_bw()
ggplot(trips_valid, aes(x=trip_length)) +
geom_histogram(color="black", fill="white", binwidth=1) +
geom_density() +
theme_bw()
ggplot(trips_valid, aes(x=trip_length)) +
geom_histogram(color="black", fill="white", binwidth=1) +
geom_density() +
theme_bw() +
geom_vline(aes(xintercept=mean(trip_length)),
color="blue", linetype="dashed", size=1)
ggplot(trips_valid, aes(x=trip_length)) +
geom_density(alpha=.2) +
theme_bw()
ggplot(trips_valid, aes(x=trip_length)) +
geom_histogram(color="black", fill="white", binwidth=1) +
geom_density(alpha=.2) +
theme_bw()
ggplot(trips_valid, aes(x=trip_length)) +
geom_density(alpha=.2) +
theme_bw()
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram(color="black", fill="white", binwidth=0.5) +
geom_density(alpha=.2) +
theme_bw()
ggplot(trips_joined, aes(x=trip_length)) +
geom_density(alpha=.2) +
theme_bw()
ggplot(trips_joined, aes(x=trip_length)) +
geom_density(alpha=.4) +
theme_bw()
ggplot(trips_joined, aes(x=trip_length)) +
geom_density(alpha=.8) +
theme_bw()
ggplot(trips_joined, aes(x=trip_length)) +
geom_density() +
theme_bw()
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram(y=..ndensity.., color="black", fill="white", binwidth=1) +
geom_density() +
theme_bw()
ggplot(trips_joined, aes(x=trip_length)) +
geom_histogram(y=ndensity, color="black", fill="white", binwidth=1) +
geom_density() +
theme_bw()
trips_joined
ggplot(trips_joined, aes(x=trip_length, color=group)) +
geom_density() +
theme_bw()
trips_joined$group
ggplot(trips_joined, aes(x=trip_length, color=group)) +
geom_density() +
theme_bw() +
trips_valid <- trips_joined[trips_joined$trip_length < 60 & trips_joined$trip_length >.5 & trips_joined$group != "none",]
ggplot(trips_joined, aes(x=trip_length, color=group)) +
geom_density() +
geom_rug(aes(x = trip_length, y = 0), position = position_jitter(height = 0))
ggplot(trips_joined, aes(x=trip_length, color=group)) +
geom_density() +
geom_rug(aes(x = trip_length, y = 0), position = position_jitter(height = 0)) +
theme_bw() +
theme(legend.position = "bottom")
ggplot(trips_valid, aes(x=trip_length)) +
geom_density() +
geom_rug(aes(x = trip_length, y = 0), position = position_jitter(height = 0)) +
theme_bw() +
theme(legend.position = "bottom")
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_density() +
geom_rug(aes(x = trip_length, y = 0), position = position_jitter(height = 0)) +
theme_bw() +
theme(legend.position = "bottom")
trips_valid <- trips_joined[trips_joined$trip_length < 60 & trips_joined$trip_length >.5,]
trips_joined$group != as.factor("none")
trips_valid <- trips_joined[trips_joined$trip_length < 60 & trips_joined$trip_length >.5 & trips_joined$group != as.factor("none"),]
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_density() +
geom_rug(aes(x = trip_length, y = 0), position = position_jitter(height = 0)) +
theme_bw() +
theme(legend.position = "bottom")
trips_valid <- trips_joined[trips_joined$trip_length < 60 & trips_joined$trip_length >.5 & trips_joined$group != as.factor("none"),]
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_density() +
theme_bw() +
theme(legend.position = "bottom")
density(trips_valid$trip_length)
density(as.numeric(trips_valid$trip_length)
trip_start = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_start_experiment, trips_joined$trip_length)
names(trip_start) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_start$time_type <- "start"
trip_stop = data.frame(trips_joined$city, trips_joined$device, trips_joined$group, trips_joined$trip_count, trips_joined$day_time, trips_joined$trip_stop_experiment, trips_joined$trip_length)
names(trip_stop) <- c("city", "device", "group", "trip_count", "day_time", "time", "trip_length")
trip_stop$time_type <- "stop"
trip_times <- rbind(trip_start, trip_stop)
trips_joined$day_of_week_trip = weekdays(as.Date(trips_joined$trip_start), abbreviate = TRUE)
x_label <- "Day of the campaign"
y_label <- "Number of trips"
# statistical test
shapiro.test(trips_joined$hour_day)
ks.test(trips_joined$hour_day)
qqnorm(trips_joined$hour_day)
wilcox.test(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length),
as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Competition",]$trip_length))
mean(as.numeric(trips_joined[trips_joined$group == "Collaboration",]$trip_length))
mean(as.numeric(trips_joined$trip_length))
# Basic line plot with points
ggplot(data=trips_joined, aes(trip_length)) +
geom_freqpoly() +
xlim(1, 120) + xlab(x_label) + ylab(y_label) +
theme_bw() + facet_grid(group ~ .)
ggplot(data=trips_joined, aes(hour_day) ) +
geom_freqpoly(bins = 24) +
xlim(0, 23) +
theme_bw() + facet_grid(city ~ .)
trip_times$trip_lenght
p <- ggplot(trip_times, aes( time, hour(trip_times$day_time), color=group ))
p + geom_line()  + theme(legend.position = "false")
p + geom_point() + theme(legend.position = "bottom") + facet_grid(city ~ .)
p <- ggplot(trip_times[], aes( time, trip_length, color=group ))
p + geom_point()
hist(as.numeric(trip_times$trip_length),breaks = 300)
myfdf <- data.frame(trips_joined$trip_length, trips_joined$trip_start, trips_joined$trip_stop)
names(myfdf) <- c
myfdf <- myfdf[]
head(trip_times$day_time)
hour(trip_times$day_time)
density(as.numeric(trips_valid$trip_length))
density(as.numeric(trips_valid$trip_length))
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_density() +
theme_bw() +
theme(legend.position = "bottom")
ggplot(trips_joined, aes(x=trip_length, color=group)) +
geom_density() +
geom_rug(aes(x = trip_length, y = 0), position = position_jitter(height = 0)) +
theme_bw() +
theme(legend.position = "bottom")
d <- density(as.numeric(trips_valid$trip_length))
plot (d)
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition"]$trip_length))
plot (d_competition)
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition"]$trip_length))
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition",]$trip_length))
plot (d_competition)
d_collaboration <- density(as.numeric(trips_valid[trips_valid$group == "Collaboration",]$trip_length))
plot (d_collaboration)
plot(d_competition$y/d_collaboration$y)
plot(d_competition$x/d_collaboration$x)
delta_x = d_competition$x - d_collaboration$x)
delta_x = d_competition$x - d_collaboration$x
delta_x
range (trips_valid$trip_length)
range (trips_valid$trip_length)
range (trips_valid[trips_valid$group == "Competition",]$trip_length)
range (trips_valid[trips_valid$group == "Collaboration",]$trip_length)
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition",]$trip_length), from = 0.5, to = 60)
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition",]$trip_length), from = 0.5, to = 60)
plot (d_competition)
d_collaboration <- density(as.numeric(trips_valid[trips_valid$group == "Collaboration",]$trip_length), from = 0.5, to = 60)
plot (d_collaboration)
plot(d_competition$y/d_collaboration$y)
plot(d_competition$x/d_collaboration$x)
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition",]$trip_length), from = 0.5, to = 60)
plot (d_competition)
d_collaboration <- density(as.numeric(trips_valid[trips_valid$group == "Collaboration",]$trip_length), from = 0.5, to = 60)
plot (d_collaboration)
plot(d_competition$y/d_collaboration$y)
plot(d_competition$x/d_collaboration$x)
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition",]$trip_length), from = 0.5, to = 60, n=1028)
plot (d_competition)
d_collaboration <- density(as.numeric(trips_valid[trips_valid$group == "Collaboration",]$trip_length), from = 0.5, to = 60, n=1028)
plot (d_collaboration)
plot(d_competition$y/d_collaboration$y)
plot(d_competition$x/d_collaboration$x)
delta_x = d_competition$x - d_collaboration$x
range (trips_valid$trip_length)
range (trips_valid[trips_valid$group == "Competition",]$trip_length)
range (trips_valid[trips_valid$group == "Collaboration",]$trip_length)
range (trips_valid[trips_valid$group == "Competition",]$trip_length)
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition",]$trip_length), from = 0.5, to = 60, n=1028)
plot (d_competition)
plot (d_competition)
d_collaboration <- density(as.numeric(trips_valid[trips_valid$group == "Collaboration",]$trip_length), from = 0.5, to = 60, n=1028)
plot (d_collaboration)
plot(d_competition$y/d_collaboration$y)
plot(d_competition$x/d_collaboration$x)
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition",]$trip_length), from = 0.5, to = 60, n=1028, bw=4.4)
plot (d_competition)
d_collaboration <- density(as.numeric(trips_valid[trips_valid$group == "Collaboration",]$trip_length), from = 0.5, to = 60, n=1028, bw=4.4)
plot (d_collaboration)
d_competition <- density(as.numeric(trips_valid[trips_valid$group == "Competition",]$trip_length), from = 0.5, to = 60, n=1028, bw=4.4)
plot (d_competition)
d_collaboration <- density(as.numeric(trips_valid[trips_valid$group == "Collaboration",]$trip_length), from = 0.5, to = 60, n=1028, bw=4.4)
plot (d_collaboration)
plot(d_competition$y/d_collaboration$y)
plot(d_competition$x/d_collaboration$x)
plot(d_collaboration$x, d/d, type="l")
plot(d_competition$x/d_collaboration$x, type="l")
plot(d_competition$y/d_collaboration$y, type="l")
plot(d_competition$x/d_collaboration$x, type="l")
plot(d_competition$y/d_collaboration$y, type="l")
as.numeric(trips_valid[trips_valid$group == "Competition",]$trip_length)
as.numeric(trips_valid[trips_valid$group == "Collaboration",]$trip_length)
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_density(n=1028, bw=4.4) +
theme_bw() +
theme(legend.position = "bottom")
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_histogram()
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_histogram()+
geom_density(n=1028, bw=4.4) +
theme_bw() +
theme(legend.position = "bottom")
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_histogram(aes(x = parent, y = ..density..),
binwidth = 1, fill = "grey", color = "black") +
geom_density(n=1028, bw=4.4) +
theme_bw() +
theme(legend.position = "bottom")
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_histogram(aes(x = trip_length, y = ..density..),
binwidth = 1, fill = "grey", color = "black") +
geom_density(n=1028, bw=4.4) +
theme_bw() +
theme(legend.position = "bottom")
ggplot(trips_valid, aes(x=trip_length, color=group)) +
geom_histogram(aes(x = trip_length, y = ..density..),
binwidth = 1, fill = "white", color = "black") +
geom_density(n=1028, bw=4.4) +
theme_bw() +
theme(legend.position = "bottom")
library(dplyr)
groups_ <- group_by(trips_valid, group, participant)
trips_joined$day_time
groups_ <- gro(trips_valid, group, participant)
groups_ <- gro(trips_valid, group, participant)
groups_ <- group_by(trips_valid, group, participant)
class(trips_valid$day_time)
hour(trips_valid$day_time)
as.numeric(trips_valid$day_time)
trips_valid$day_time <- as.numeric(trips_valid$day_time)
groups_ <- group_by(trips_valid, group, participant)
summarize(groups_)
groups_ <- group_by(trips_valid$trip_length, group, participant)
summarize(trips_valid)
groups_ <- group_by(trips_valid, group, participant)
summarize(mean = mean(groups_), n = n() )
summarize(mean = mean(trip_length), n = n() )
summarize(groups_, mean = mean(trip_length), n = n() )
