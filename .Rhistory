install.packages("tm")
install.packages("tm")
# Setup
library(tm)
library(SnowballC)
library(wordcloud)
table_participants = read.csv('data/Cyclist_Experiment.csv')
table_tags <- read.csv('data/Cyclist_Tag.csv', sep = '\t')
table_tags_polarity <- read.csv('data/Tags_polarity.csv')
tags_participants = merge(table_tags,table_participants)
tags_participants$campaign_day = as.Date(tags_participants$X_created_at) - as.Date(tags_participants$questionnaire1) +1
table_tags_polarity_joined <- merge(tags_participants[!is.na(tags_participants$campaign_day),], table_tags_polarity, all = TRUE)
table_tags_polarity_joined$participant[table_tags_polarity_joined$city == "Castell贸" & !is.na(table_tags_polarity_joined$participant)] <-
table_tags_polarity_joined$participant[table_tags_polarity_joined$city == "Castell贸"& !is.na(table_tags_polarity_joined$participant)] - 20
table_tags_polarity_joined$participant[table_tags_polarity_joined$city == "Malta" & !is.na(table_tags_polarity_joined$participant)] <-
table_tags_polarity_joined$participant[table_tags_polarity_joined$city == "Malta"& !is.na(table_tags_polarity_joined$participant)] - 40
new_tags <- table_tags_polarity_joined[is.na(table_tags_sense_joined$sentiment_polarity),]
polarised_tags <- table_tags_polarity_joined[!is.na(table_tags_sense_joined$sentiment_polarity),]
# Cloud 1 - All Tags
docs <- Corpus( VectorSource( as.String(table_tags_polarity_joined$text_en) ) )
inspect(docs)
toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
set.seed(1234)
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
max.words=200, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"))
# Cloud 1 - All Tags
docs <- Corpus( VectorSource( as.String(table_tags_polarity_joined$text_en) ) )
# Setup
library(tm)
library(SnowballC)
library(wordcloud)
table_participants = read.csv('data/Cyclist_Experiment.csv')
setwd("~/r-studioProjects/Survey-Analysis-Competition-Vs-Collaboration-in-geogames")
library(wordcloud)
table_participants = read.csv('data/Cyclist_Experiment.csv')
table_tags <- read.csv('data/Cyclist_Tag.csv', sep = '\t')
table_tags_polarity <- read.csv('data/Tags_polarity.csv')
tags_participants = merge(table_tags,table_participants)
tags_participants$campaign_day = as.Date(tags_participants$X_created_at) - as.Date(tags_participants$questionnaire1) +1
table_tags_polarity_joined <- merge(tags_participants[!is.na(tags_participants$campaign_day),], table_tags_polarity, all = TRUE)
table_tags_polarity_joined$participant[table_tags_polarity_joined$city == "Castell贸" & !is.na(table_tags_polarity_joined$participant)] <-
table_tags_polarity_joined$participant[table_tags_polarity_joined$city == "Castell贸"& !is.na(table_tags_polarity_joined$participant)] - 20
table_tags_polarity_joined$participant[table_tags_polarity_joined$city == "Malta" & !is.na(table_tags_polarity_joined$participant)] <-
table_tags_polarity_joined$participant[table_tags_polarity_joined$city == "Malta"& !is.na(table_tags_polarity_joined$participant)] - 40
new_tags <- table_tags_polarity_joined[is.na(table_tags_sense_joined$sentiment_polarity),]
polarised_tags <- table_tags_polarity_joined[!is.na(table_tags_sense_joined$sentiment_polarity),]
# Cloud 1 - All Tags
docs <- Corpus( VectorSource( as.String(table_tags_polarity_joined$text_en) ) )
inspect(docs)
toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
set.seed(1234)
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
max.words=200, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"))
# Setup
library(ggplot2)
table_participants <- read.csv('data/Cyclist_Experiment.csv')
table_tags <- read.csv('data/Cyclist_Tag.csv', sep = '\t')
table_tags_polarity <- read.csv('data/Tags_polarity.csv')
table_tags_sense_joined <- merge(table_tags, table_tags_polarity, all = TRUE)
tags_joined <- merge(table_tags_sense_joined,table_participants)
tags_joined$campaign_day <- as.Date(tags_joined$X_created_at) - as.Date(tags_joined$questionnaire1) +1
trips_joined$day_of_week_trip <- weekdays(as.Date(trips_joined$trip_start), abbreviate = TRUE)
x_label <- "Day of the campaign"
y_label <- "Number of tags per day"
ggplot(data=tags_joined, aes(campaign_day, colour = city)) +
geom_freqpoly( bins = 10 ) +
xlim(1, 10) + xlab(x_label) + ylab(y_label) +
theme(legend.position = "none")
# Histogram with tags per day and the sense of its text
legend_title <- "Sentiment Polarity"
ggplot(data=tags_joined, aes(campaign_day, fill = sentiment_polarity)) +
geom_area(stat = "bin") +
theme_bw() +
scale_fill_manual(values = c("Positive" = "#5ab4ac",
"Negative" = "#d8b365",
"Neutral " = "#c7eae5"),
na.value = "#bdbdbd") +
xlim(1, 30) + xlab(x_label) + ylab(y_label) +
theme(legend.position = 'bottom') +
labs(fill = legend_title)
# Basic plot line with the number of tags recorded per day of the campaign
ggplot(data=tags_joined, aes(campaign_day)) +
geom_freqpoly(bins = 30) +
xlim(1, 30) + xlab(x_label) + ylab(y_label) +
theme_bw()
ggplot(data=tags_joined, aes(campaign_day, colour = city)) +
geom_freqpoly( bins = 10 ) +
xlim(1, 10) + xlab(x_label) + ylab(y_label) +
theme(legend.position = "none")
# Plot for showing the amount of tags that each participant had provided
# during the experiment,
ggplot(table_tags_polarity_joined[!is.na(table_tags_polarity_joined$city),], aes(participant, tag_coung )) +
geom_point(aes(colour = factor(sentiment_polarity))) +
theme_bw() +
facet_grid(city ~ .) +
theme(legend.position="bottom")
ggplot(table_tags_polarity_joined[!is.na(table_tags_polarity_joined$city),], aes(participant )) +
geom_bar(aes(fill=sentiment_polarity)) +
theme_bw() +
facet_grid(city ~ .) +
theme(legend.position="bottom")
# Setup
library(ggplot2)
table_participants = read.csv('data/Cyclist_Experiment.csv')
table_trips = read.csv('data/Cyclist_Trip.csv', sep = '\t')
trips_joined = merge(table_participants,table_trips)
trips_joined$campaign_day = as.Date(trips_joined$X_created_at) - as.Date(trips_joined$questionnaire1) +1
trips_joined$day_of_week_trip = weekdays(as.Date(trips_joined$trip_start), abbreviate = TRUE)
x_label <- "Day of the campaign"
y_label <- "Number of trips"
# Basic line plot with points
ggplot(data=trips_joined[trips_joined$city == "Malta",], aes(campaign_day)) +
geom_freqpoly(bins = 30) +
xlim(1, 30) + xlab(x_label) + ylab(y_label) +
theme_bw()
trip_lengt <- as.POSIXct(trips_joined$trip_stop) - as.POSIXct(trips_joined$trip_start)
GG
ggplot( trip_lengt, aes(nrow(trip_lengt) )) +
geom_bar()
trip_lengt
ggplot( trip_lengt, aes(nrow(trip_lengt) )) +
geom_bar()
nrow(trip_lengt)
as.POSIXct(trips_joined$trip_stop)
as.POSIXt(trips_joined$trip_stop)
as.POSIXlt(trips_joined$trip_stop)
trips_joined$trip_stop
as.numeric(trips_joined$trip_stop)
trips_joined$trip_stop
as.POSIXct.POSIXlt(trips_joined$trip_stop)
as.POSIXLt(trips_joined$trip_stop)
as.POSIXlt(trips_joined$trip_stop)
unclass(as.POSIXlt(trips_joined$trip_stop))
# Graph showing the length of the trip
trips_joined$trip_stop
strftime(trips_joined$trip_stop,"%Y-%m-%dT%H:%M:%S")
ISOdatetime(trips_joined$trip_stop)
strftime(trips_joined$trip_stop, "%Y-%m-%d%T")
# Graph showing the length of the trip
trips_joined$trip_stop
strftime(trips_joined$trip_stop, format= "%Y-%m-%d %H:%M:S.")
# Graph showing the length of the trip
trips_joined$trip_stop
strftime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:S.")
strftime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:S.Z")
strftime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%S.Z")
strftime(trips_joined$trip_stop, format= "%Y-%m-%d%H:%M:%S.Z")
strftime(trips_joined$trip_stop, format= "%Y-%m-%d %H:%M:%S.Z")
strftime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%S%Z")
strftime(trips_joined$trip_stop, format= "%Y-%m-%d%T%H:%M:%S%Z")
strftime(trips_joined$trip_stop, format= "%Y-%m-%d% %H:%M:%S%Z")
strftime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%SZ")
strftime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%S.Z")
strftime(trips_joined$trip_stop, format= "%Y-%m-%dT%H:%M:%SZ")
format(as.POSIXlt(trips_joined$trip_stop),format = '%T')
trips_joined$trip_stop
sub('.*T(.*)Z', '\\1', trips_joined$trip_stop)
time_txt <- sub('.*T(.*)Z', '\\1', trips_joined$trip_stop)
strftime(time_txt)
time_txt
strftime(time_txt, format = "%H:%M:%S.")
strftime(time_txt, format = "%H:%M:%S")
time_txt
strftime(time_txt, format = "%I:%M:%S")
trips_joined$trip_stop
strftime(trips_joined$trip_stop, format= "%y-%m-%dT%H:%M:%SZ")
format(as.POSIXlt(trips_joined$trip_stop),format = '%T')
time_txt <- sub('.*T(.*)Z', '\\1', trips_joined$trip_stop)
time_txt
strftime(time_txt, format = "%I:%M:%S")
# Graph showing the length of the trip
trips_joined$trip_stop
strftime(trips_joined$trip_stop, format= "%y-%m-%dT%H:%M:%SZ")
time_txt <- sub('.*T(.*)Z', '\\1', trips_joined$trip_stop)
time_txt
strftime(time_txt, format = "%H:%M:%S")
?strftime
strftime(as.character(time_txt), format = "%H:%M:%S")
strftime(as.character(time_txt), format = "%H:%M:%OS")
as.character(time_txt)
strftime(as.character(time_txt), format = "%H:%M:%OS")
strptime(as.character(time_txt), format = "%H:%M:%OS")
strptime(time_txt, format = "%H:%M:%OS")
strptime(trips_joined$trip_stop, format= "%y-%m-%dT%H:%M:%SZ")
# Graph showing the length of the trip
trips_joined$trip_stop
strptime(as.characer(trips_joined$trip_stop), format= "%y-%m-%dT%H:%M:%SZ")
strptime(as.character(trips_joined$trip_stop), format= "%y-%m-%dT%H:%M:%SZ")
as.character(trips_joined$trip_stop)
strptime(as.character(trips_joined$trip_stop), format= "%y-%m-%d%H:%M:%S)
strptime(as.character(trips_joined$trip_stop), format= "%y-%m-%d%H:%M:%S")
strptime(as.character(trips_joined$trip_stop), format= "%y-%m-%dT%H:%M:%S%Z")
strptime(as.character(trips_joined$trip_stop), format= "%y-%m-%d\T%H:%M:%S%Z")
strptime(as.character(trips_joined$trip_stop), format= "%y-%m-%dT%H:%M:%OS%Z")
as.POSIXct((as.character(trips_joined$trip_stop)),
format = "%Y-%m-%dT%H:%M:%OS",
tz = "Z")
strptime(as.character(trips_joined$trip_stop), format= "%y-%m-%dT%H:%M:%OS")
as.POSIXct((as.character(trips_joined$trip_stop)),
format = "%Y-%m-%dT%H:%M:%OS",
tz = "Z")
strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS")
as.POSIXct((as.character(trips_joined$trip_stop)),
format = "%Y-%m-%dT%H:%M:%OS",
tz = "Z")
strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OSZ")
strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS%Z")
strptime(as.character(trips_joined$trip_stop), format= "%Y-%m-%dT%H:%M:%OS")
table_participants = read.csv('data/Cyclist_Experiment.csv')
View(table_participants)
