table_trips = read.csv('data/Cyclist_Trip.csv', sep = '\t')
table_tags <- read.csv('data/Cyclist_Tag.csv', sep = '\t')
table_tags_polarity <- read.csv('data/Tags_polarity.csv')
tags_polarity <- merge(table_tags, table_tags_polarity, by = "text", all.x = TRUE)
tags_polarity <- unique(tags_polarity)  # Remove duplicated rows due to tags equally spelled in different languages
table_location = read.csv('data/Cyclist_Location.csv', sep = '\t')
table_location$time_gps <-  strptime(table_location$time_gps, format= "%Y-%m-%dT%H:%M:%OS")
table_trips_length = read.csv('data/Cyclist_Trip_length.csv')
View(table_trips_length)
View(table_trips_length)
table_answers = read.csv('data/Questionnaire_Answers.csv')
table_answers$group <- "none"
table_answers[which(table_answers$competition_1 >= -3),]$group <- "Competition"
table_answers[which(table_answers$collaboration_1 >= -3),]$group <- "Collaboration"
trips_joined <- merge(table_trips, table_participants)
trips_joined <- merge(trips_joined, table_trips_length, all.x = FALSE)
trips_joined <- merge(trips_joined, table_trips_length, all.x = TRUE)
trips_joined <- merge(table_trips, table_participants)
trips_joined <- merge(trips_joined, table_trips_length, all.x = TRUE)
trips_joined <- merge(trips_joined, table_answers)
source("scripts/setup.R")
# Trip_record, a list with the union of the trips recorded with the app and the estimations of distance and number of points coming from the location_record
trip_record <- data.frame(trips_joined$participant, trips_joined$device, trips_joined$city, trips_joined$group, trips_joined$trip_count, trips_joined$point_count,
trips_joined$trip_start, trips_joined$trip_stop, trips_joined$questionnaire1, trips_joined$questionnaire_2, trips_joined$length_raw,
trips_joined$length_sim, trips_joined$dif_length, trips_joined$dem_gender, trips_joined$dem_age,
trips_joined$gaming_mobile_time, trips_joined$gaming_app_cycling, trips_joined$feedback_1, trips_joined$feedback_4)
names(trip_record) <- c("participant", "device", "city", "group", "trip_count", "point_count", "trip_start", "trip_stop", "exper_start", "exper_end", "length_raw",
"length_sim", "dif_length", "gender", "age", "mobile_time", "app_cycling", "feedback_reminder", "feedback_function")
# Estimation of some characteristics of the trips, hour of the day, time length in minutes, time referred to the start of the experiment
trip_record$day_time <-  format ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trip_record$day_time <- strptime(trip_record$day_time, format = "%H:%M:%OS")
trip_record$hour_day <- hour(trip_record$day_time) + minute(trip_record$day_time) / 60.0
trip_record$trip_length <- difftime( strptime(trip_record$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trip_record$trip_start_experiment <- difftime ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$exper_start, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trip_record$trip_stop_experiment <- difftime( strptime(as.character(trip_record$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trip_record$exper_start), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_record$trip_day_experiment <- round(trip_record$trip_start_experiment, digits = 0) + 1
trip_record$trip_week_experiment <- ceiling(trip_record$trip_day_experiment / 7)
p_trips <- ggplot(trip_record, aes(trip_week_experiment))
p_trips + geom_bar(stat = 'count')
trip_record_engaged <- trip_record[trip_day_experiment>2,]
trip_record_engaged <- trip_record[trip_record$trip_day_experiment>2,]
p_trips <- ggplot(trip_record_engaged, aes(trip_week_experiment))
p_trips + geom_bar(stat = 'count')
trip_record_engaged <- trip_record[trip_record$trip_week_experiment>2,]
p_trips <- ggplot(trip_record_engaged, aes(trip_week_experiment))
p_trips + geom_bar(stat = 'count')
p_trips <- ggplot(trip_record_engaged, aes(participant))
p_trips + geom_bar(stat = 'count')
p_trips <- ggplot(trip_record_engaged, aes(trip_week_experiment))
p_trips + geom_bar(stat = 'count')
p_trips <- ggplot(trip_record_engaged, aes(city))
p_trips + geom_bar(stat = 'count')
p_trips <- ggplot(trip_record_engaged, aes(participant))
p_trips + geom_bar(stat = 'count')
# Participants after the experiment
trip_record_engaged %>%
group_by(city, week) %>%
summarise(n = n())
# Participants after the experiment
trip_record_engaged %>%
group_by(city) %>%
summarise(n = n())
View(trip_record)
trip_record_engaged <- trip_record[trip_record$trip_week_experiment>2, c('participant', 'device', 'city')]
p_trips <- ggplot(trip_record_engaged, aes(participant))
p_trips + geom_bar(stat = 'count')
# Participants after the experiment
trip_record_engaged %>%
group_by(city) %>%
summarise(n = n())
trip_record_engaged <- trip_record[trip_record$trip_week_experiment>2, c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
p_trips <- ggplot(trip_record_engaged, aes(participant))
p_trips + geom_bar(stat = 'count')
# Participants after the experiment
trip_record_engaged %>%
group_by(city) %>%
summarise(n = n())
# Participants after the experiment
trip_record_engaged %>%
group_by(city, participant) %>%
summarise(n = n())
trip_record_after <- trip_record[trip_record$trip_start>trip_stop_experiment, c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
trip_record_after <- trip_record[trip_record$trip_start>trip_record$trip_stop_experiment, c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
View(trip_record_after)
# Estimation of some characteristics of the trips, hour of the day, time length in minutes, time referred to the start of the experiment
trip_record$trip_start <- strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS")
trip_record$day_time <-  format ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trip_record$day_time <- strptime(trip_record$day_time, format = "%H:%M:%OS")
trip_record$hour_day <- hour(trip_record$day_time) + minute(trip_record$day_time) / 60.0
trip_record$trip_length <- difftime( strptime(trip_record$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trip_record$trip_start_experiment <- difftime ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$exper_start, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trip_record$trip_stop_experiment <- difftime( strptime(as.character(trip_record$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trip_record$exper_start), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_record$trip_day_experiment <- round(trip_record$trip_start_experiment, digits = 0) + 1
trip_record$trip_week_experiment <- ceiling(trip_record$trip_day_experiment / 7)
trip_record_after <- trip_record[trip_record$trip_start>trip_record$trip_stop_experiment, c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
View(trip_record)
trip_record_after <- trip_record[difftime(trip_record$trip_start, trip_record$exper_end) , c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
# Participants after the experim
trip_after_experiment <- trip_record[which( strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS"),
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
units='minutes') > 0,
]
# Participants after the experim
trip_after_experiment <- trip_record[difftime( strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS"),
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS")) > 0,
]
# Participants after the experim
trip_after_experiment <- trip_record[difftime( strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS"),
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS")) > 0,
]
View(trip_after_experiment)
# Participants after the experim
trip_after_experiment <- trip_record[ which( difftime( strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS"),
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS")) ) > 0,
]
# Participants after the experim
trip_after_experiment <- trip_record[ which( difftime( strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS"),
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS")) > 0 ),
]
View(trip_after_experiment)
# Participants after the experim
trip_after_experiment$after_experiment <- difftime( strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS"),
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"))
source("scripts/setup.R")
# Trip_record, a list with the union of the trips recorded with the app and the estimations of distance and number of points coming from the location_record
trip_record <- data.frame(trips_joined$participant, trips_joined$device, trips_joined$city, trips_joined$group, trips_joined$trip_count, trips_joined$point_count,
trips_joined$trip_start, trips_joined$trip_stop, trips_joined$questionnaire1, trips_joined$questionnaire_2, trips_joined$length_raw,
trips_joined$length_sim, trips_joined$dif_length, trips_joined$dem_gender, trips_joined$dem_age,
trips_joined$gaming_mobile_time, trips_joined$gaming_app_cycling, trips_joined$feedback_1, trips_joined$feedback_4)
names(trip_record) <- c("participant", "device", "city", "group", "trip_count", "point_count", "trip_start", "trip_stop", "exper_start", "exper_end", "length_raw",
"length_sim", "dif_length", "gender", "age", "mobile_time", "app_cycling", "feedback_reminder", "feedback_function")
# Estimation of some characteristics of the trips, hour of the day, time length in minutes, time referred to the start of the experiment
trip_record$trip_start <- strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS")
trip_record$day_time <-  format ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trip_record$day_time <- strptime(trip_record$day_time, format = "%H:%M:%OS")
trip_record$hour_day <- hour(trip_record$day_time) + minute(trip_record$day_time) / 60.0
trip_record$trip_length <- difftime( strptime(trip_record$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trip_record$trip_start_experiment <- difftime ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$exper_start, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trip_record$trip_stop_experiment <- difftime( strptime(as.character(trip_record$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trip_record$exper_start), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_record$trip_day_experiment <- round(trip_record$trip_start_experiment, digits = 0) + 1
trip_record$trip_week_experiment <- ceiling(trip_record$trip_day_experiment / 7)
trip_record_engaged <- trip_record[trip_record$trip_week_experiment>2, c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
p_trips <- ggplot(trip_record_engaged, aes(participant))
p_trips + geom_bar(stat = 'count')
# Participants after the experim
trip_after_experiment$after_experiment <- difftime( strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS"),
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"))
trip_record$trip_start
trip_record$exper_end
difftime( strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS"),
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"))
strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS")
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS")
# Participants after the experim
trip_after_experiment$after_experiment <- difftime( trip_record$trip_start), trip_record$exper_end)
difftime( trip_record$trip_start, trip_record$exper_end)
# Participants after the experim
trip_after_experiment$after_experiment <- difftime( trip_record$trip_start, trip_record$trip_stop_experiment)
difftime( trip_record$trip_start, trip_record$trip_stop_experiment)
strptime(as.character(trip_record$trip_start), format= "%Y-%m-%dT%H:%M:%OS")
strptime(as.character(trip_record$trip_stop_experiment), format= "%Y-%m-%dT%H:%M:%OS")
View(trip_record)
strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS")
difftime( trip_record$trip_start, strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"))
# Participants after the experim
trip_after_experiment <- trip_record
trip_after_experiment$after_experiment <- difftime( trip_record$trip_start, strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"))
View(trip_after_experiment)
trip_after_experiment$after_experiment <- difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"), trip_record$trip_start)
View(trip_after_experiment)
# Participants after the experim
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) > 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
View(trip_after_experiment)
View(trip_after_experiment)
# Participants after the experim
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) > 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment', 'trip_start', 'exper_end')]
View(trip_after_experiment)
View(trip_after_experiment)
# Participants after the experim
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) < 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment', 'trip_start', 'exper_end')]
View(trip_after_experiment)
# Participants after the experim
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) < 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment', 'trip_start', 'exper_end')]
# Participants after the experim
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) < 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment', 'trip_start', 'exper_end')]
trip_after_experiment$after_experiment <- difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"), trip_record$trip_start)
View(trip_after_experiment)
# Participants after the experim
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) < 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment', 'trip_start', 'exper_end')]
trip_after_experiment %>%
group_by(city, participant) %>%
summarise(n = n())
trip_after_experiment %>%
group_by(city, participant) %>%
summarise(n = n())
# Setup
library(ggplot2)
require(lubridate)
library(dplyr)
source("scripts/setup.R")
# Trip_record, a list with the union of the trips recorded with the app and the estimations of distance and number of points coming from the location_record
trip_record <- data.frame(trips_joined$participant, trips_joined$device, trips_joined$city, trips_joined$group, trips_joined$trip_count, trips_joined$point_count,
trips_joined$trip_start, trips_joined$trip_stop, trips_joined$questionnaire1, trips_joined$questionnaire_2, trips_joined$length_raw,
trips_joined$length_sim, trips_joined$dif_length, trips_joined$dem_gender, trips_joined$dem_age,
trips_joined$gaming_mobile_time, trips_joined$gaming_app_cycling, trips_joined$feedback_1, trips_joined$feedback_4)
names(trip_record) <- c("participant", "device", "city", "group", "trip_count", "point_count", "trip_start", "trip_stop", "exper_start", "exper_end", "length_raw",
"length_sim", "dif_length", "gender", "age", "mobile_time", "app_cycling", "feedback_reminder", "feedback_function")
# Estimation of some characteristics of the trips, hour of the day, time length in minutes, time referred to the start of the experiment
trip_record$trip_start <- strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS")
trip_record$day_time <-  format ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trip_record$day_time <- strptime(trip_record$day_time, format = "%H:%M:%OS")
trip_record$hour_day <- hour(trip_record$day_time) + minute(trip_record$day_time) / 60.0
trip_record$trip_length <- difftime( strptime(trip_record$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trip_record$trip_start_experiment <- difftime ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$exper_start, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trip_record$trip_stop_experiment <- difftime( strptime(as.character(trip_record$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trip_record$exper_start), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_record$trip_day_experiment <- round(trip_record$trip_start_experiment, digits = 0) + 1
trip_record$trip_week_experiment <- ceiling(trip_record$trip_day_experiment / 7)
trip_record_engaged <- trip_record[trip_record$trip_week_experiment>2, c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
p_trips <- ggplot(trip_record_engaged, aes(participant))
p_trips + geom_bar(stat = 'count')
# Participants after the experim
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) < 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment', 'trip_start', 'exper_end')]
trip_after_experiment %>%
group_by(city, participant) %>%
summarise(n = n())
# Participants after the experim
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) < 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
trip_after_experiment %>%
group_by(city, participant) %>%
summarise(n = n())
trips_after <- trip_after_experiment %>%
group_by(city, participant) %>%
summarise(n = n())
View(trips_after)
# Participants after three weeks
trip_after_threew_w <- trip_record[trip_record$trip_week_experiment > 2,
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
View(trip_after_threew_w)
# Participants after three weeks
trip_after_threew_w <- trip_record[which(trip_record$trip_week_experiment > 2),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
trip_record$trip_week_experiment
# Estimation of some characteristics of the trips, hour of the day, time length in minutes, time referred to the start of the experiment
trip_record$day_time <-  format ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
# Setup
library(ggplot2)
require(lubridate)
library(dplyr)
source("scripts/setup.R")
# Trip_record, a list with the union of the trips recorded with the app and the estimations of distance and number of points coming from the location_record
trip_record <- data.frame(trips_joined$participant, trips_joined$device, trips_joined$city, trips_joined$group, trips_joined$trip_count, trips_joined$point_count,
trips_joined$trip_start, trips_joined$trip_stop, trips_joined$questionnaire1, trips_joined$questionnaire_2, trips_joined$length_raw,
trips_joined$length_sim, trips_joined$dif_length, trips_joined$dem_gender, trips_joined$dem_age,
trips_joined$gaming_mobile_time, trips_joined$gaming_app_cycling, trips_joined$feedback_1, trips_joined$feedback_4)
names(trip_record) <- c("participant", "device", "city", "group", "trip_count", "point_count", "trip_start", "trip_stop", "exper_start", "exper_end", "length_raw",
"length_sim", "dif_length", "gender", "age", "mobile_time", "app_cycling", "feedback_reminder", "feedback_function")
# Estimation of some characteristics of the trips, hour of the day, time length in minutes, time referred to the start of the experiment
trip_record$day_time <-  format ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trip_record$day_time <- strptime(trip_record$day_time, format = "%H:%M:%OS")
trip_record$hour_day <- hour(trip_record$day_time) + minute(trip_record$day_time) / 60.0
trip_record$trip_length <- difftime( strptime(trip_record$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trip_record$trip_start_experiment <- difftime ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$exper_start, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trip_record$trip_stop_experiment <- difftime( strptime(as.character(trip_record$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trip_record$exper_start), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_record$trip_day_experiment <- round(trip_record$trip_start_experiment, digits = 0) + 1
trip_record$trip_week_experiment <- ceiling(trip_record$trip_day_experiment / 7)
# Trips and participants after the experiment
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) < 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
trips_after <- trip_after_experiment %>%
group_by(city, participant) %>%
summarise(n = n())
View(trips_after)
trips_after <- trip_after_experiment %>%
group_by(city, participant) %>%
summarise(trips = n())
View(trips_after)
# Participants after three weeks
trip_after_threew_w <- trip_record[which(trip_record$trip_week_experiment > 2),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
View(trip_after_threew_w)
trips_after_three <- trip_after_threew_w %>%
group_by(city, participant) %>%
summarise(trips = n())
View(trips_after_three)
# Setup
library(ggplot2)
require(lubridate)
library(dplyr)
source("scripts/setup.R")
# Trip_record, a list with the union of the trips recorded with the app and the estimations of distance and number of points coming from the location_record
trip_record <- data.frame(trips_joined$participant, trips_joined$device, trips_joined$city, trips_joined$group, trips_joined$trip_count, trips_joined$point_count,
trips_joined$trip_start, trips_joined$trip_stop, trips_joined$questionnaire1, trips_joined$questionnaire_2, trips_joined$length_raw,
trips_joined$length_sim, trips_joined$dif_length, trips_joined$dem_gender, trips_joined$dem_age,
trips_joined$gaming_mobile_time, trips_joined$gaming_app_cycling, trips_joined$feedback_1, trips_joined$feedback_4)
names(trip_record) <- c("participant", "device", "city", "group", "trip_count", "point_count", "trip_start", "trip_stop", "exper_start", "exper_end", "length_raw",
"length_sim", "dif_length", "gender", "age", "mobile_time", "app_cycling", "feedback_reminder", "feedback_function")
# Estimation of some characteristics of the trips, hour of the day, time length in minutes, time referred to the start of the experiment
trip_record$day_time <-  format ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), "%H:%M:%OS")
trip_record$day_time <- strptime(trip_record$day_time, format = "%H:%M:%OS")
trip_record$hour_day <- hour(trip_record$day_time) + minute(trip_record$day_time) / 60.0
trip_record$trip_length <- difftime( strptime(trip_record$trip_stop, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), units='mins')
trip_record$trip_start_experiment <- difftime ( strptime(trip_record$trip_start, format= "%Y-%m-%dT%H:%M:%OS"), strptime(trip_record$exper_start, format= "%Y-%m-%dT%H:%M:%OS"), units='days')
trip_record$trip_stop_experiment <- difftime( strptime(as.character(trip_record$trip_stop), format= "%Y-%m-%dT%H:%M:%OS"), strptime(as.character(trip_record$exper_start), format= "%Y-%m-%dT%H:%M:%OS") , units='days')
trip_record$trip_day_experiment <- round(trip_record$trip_start_experiment, digits = 0) + 1
trip_record$trip_week_experiment <- ceiling(trip_record$trip_day_experiment / 7)
# Trips and participants after the experiment
trip_after_experiment <- trip_record[which(difftime( strptime(as.character(trip_record$exper_end), format= "%Y-%m-%dT%H:%M:%OS"),
trip_record$trip_start) < 0),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
trips_after <- trip_after_experiment %>%
group_by(city, participant) %>%
summarise(trips = n())
# Participants after three weeks
trip_after_threew_w <- trip_record[which(trip_record$trip_week_experiment > 2),
c('participant', 'device', 'city', 'group', 'hour_day', 'trip_day_experiment', 'trip_week_experiment')]
trips_after_three <- trip_after_threew_w %>%
group_by(city, participant) %>%
summarise(trips = n())
# Participants
p_trips <- ggplop(trip_record, aes(trip_week_experiment, fill = 'group'))
# Participants
p_trips <- ggplot(trip_record, aes(trip_week_experiment, fill = 'group'))
p_trips + geom_bar()
p_trips + geom_bar(stat = 'count')
# Participants
p_trips <- ggplot(trip_record, aes(trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count')
p_trips + geom_bar(stat = 'count') + facet_grid(city ~ .)
p_trips + geom_bar(stat = 'count') + facet_grid(city ~ .) + theme_bw()
p_trips + geom_bar(stat = 'count') + facet_grid(city ~ .) + cood_flip() + theme_bw()
p_trips + geom_bar(stat = 'count') + facet_grid(city ~ .) + coord_flip() + theme_bw()
p_trips + geom_bar(aes((..count..)/sum(..count..))) + facet_grid(city ~ .) + coord_flip() + theme_bw()
# Participants
p_trips <- ggplot(trip_record, aes(x=trip_week_experiment, fill = group))
p_trips + geom_bar(aes((..count..)/sum(..count..))) + facet_grid(city ~ .) + coord_flip() + theme_bw()
p_trips + geom_bar(stat = 'count') + geom_text(stat = 'count', aes(label = (..count..))) + facet_grid(city ~ .) + coord_flip() + theme_bw()
p_trips + geom_bar(stat = 'count') + geom_text(stat = 'count', aes(label = (..count..)/sum(..count..))) + facet_grid(city ~ .) + coord_flip() + theme_bw()
geom_text(stat = 'count', aes(label = round((..count..)/sum(..count..)),0) +
geom_text(stat = 'count', aes(label = round((..count..)/sum(..count..),0)) +
p_trips + geom_bar(stat = 'count') +
geom_text(stat = 'count', aes(label = round((..count..)/sum(..count..),0))) +
facet_grid(city ~ .) + coord_flip() + theme_bw()
p_trips + geom_bar(stat = 'count') +
geom_text(stat = 'count', aes(label = round((..count..)/sum(..count..),digits = 0))) +
facet_grid(city ~ .) + coord_flip() + theme_bw()
p_trips + geom_bar(stat = 'count') +
geom_text(stat = 'count', aes(label = (..count..)/sum(..count..)*100 )) +
facet_grid(city ~ .) + coord_flip() + theme_bw()
p_trips + geom_bar(stat = 'count') +
geom_text(stat = 'count', aes(label = round((..count..)/sum(..count..)*100,0) )) +
facet_grid(city ~ .) + coord_flip() + theme_bw()
p_trips + geom_bar(stat = 'count') +
geom_text(stat = 'count', aes(label = round((..count..)/sum(..count..)*100,0) )) +
facet_grid(city ~ .) + coord_flip() + theme(legend.position = 'bottom') + theme_bw()
p_trips + geom_bar(stat = 'count') +
geom_text(stat = 'count', aes(label = round((..count..)/sum(..count..)*100,0) )) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
geom_text(stat = 'count', aes(label = round((..count..)/sum(..count..)*100,0) )) +
coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
geom_text(stat = 'count', aes(label = round((..count..)) )) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
geom_text(stat = 'count', aes(label = round((..count..)) )) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
# Participants
l_title <- 'Experiment Condition'
p_trips <- ggplot(trip_record, aes(trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
geom_text(stat = 'count', aes(label = round((..count..)) )) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9")) +
geom_text(stat = 'count', aes(label = round((..count..)) )) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c( "#A9A9A9", "#D3D3D3")) +
geom_text(stat = 'count', aes(label = round((..count..)) )) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
geom_text(stat = 'count', aes(label = round((..count..)) )) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
# Participants
l_title <- 'Condition'
p_trips <- ggplot(trip_record, aes(trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips <- ggplot(trip_record[which(trip_record$group != 'none'),], aes(trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
y_title <- 'Week'
p_trips <- ggplot(trip_record[which(trip_record$group != 'none'),], aes(trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) +
facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
# Participants
l_title <- 'Condition'
y_title <- 'Week'
x_title <- 'Number of Trips'
p_trips <- ggplot(trip_record[which(trip_record$group != 'none'),], aes(trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
# Participants
l_title <- 'Condition'
x_title <- 'Week'
y_title <- 'Number of Trips'
p_trips <- ggplot(trip_record[which(trip_record$group != 'none'),], aes(trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips <- ggplot(trip_record[which(trip_record$group != 'none'),], aes(x=trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'bin') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips <- ggplot(trip_record[which(trip_record$group != 'none'),], aes(x=reorder(trip_week_experiment), fill = group))
p_trips + geom_bar(stat = 'count') +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') + scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + scale_y_reverse() + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips <- ggplot(trip_record[which(trip_record$group != 'none'),], aes(x=trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count') + scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + scale_y_reverse() + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips <- ggplot(trip_record[which(trip_record$group != 'none'),], aes(trip_week_experiment, fill = group))
p_trips + geom_bar(stat = 'count') + scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + scale_y_reverse() + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
p_trips + geom_bar(stat = 'count') + scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
ylab(y_title) + xlab(x_title) + facet_grid(city ~ .) + scale_x_reverse() + coord_flip() + theme_bw() + theme(legend.position = 'bottom')
library(tm)
library(SnowballC)
library(wordcloud)
library(ggplot2)
# Setup
source("scripts/setup.R")
tags_experiment <- tags_joined[!is.na(tags_joined$participant),]
tags_experiment <- tags_experiment[which(!is.na(tags_experiment$group) & tags_experiment$group != 'none'),]
tags_experiment <- tags_experiment[which(!is.na(tags_experiment$sentiment_polarity)),]
x_title <- 'Day of the Campaign'
y_title <- 'Number of tags'
l_title <- 'Sentiment Polarity'
# Bar chart showing the number of
q_plot <- ggplot(tags_experiment, aes(campaign_day, fill=sentiment_polarity))
q_plot + geom_bar(stat = 'bin') + xlim(0,20) +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
xlab(x_title) + ylab(y_title) + theme_bw() + theme(legend.position = 'bottom') +
facet_grid(group ~ .)
tags_city <- ggplot(tags_experiment, aes(city))
tags_city + geom_bar(stat = 'count') + geom_label(stat = 'count', aes(label=..count..), vjust=-.1)
# Table with the list of tags and its frequency
docs <- Corpus( VectorSource( as.String(tags_experiment$text_en) ) )
inspect(docs)
toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
# Tags frequency in a data frame
top_words <- data.frame(word = names(v),freq=v)
set.seed(1234)
wordcloud(words = top_words$word, freq = d$freq, min.freq = 1,
max.words=200, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(8, "Dark2"))
q_plot + geom_bar(stat = 'bin') + xlim(0,20) +
scale_fill_manual(l_title, values = c("#303030", "#A9A9A9", "#D3D3D3")) +
xlab(x_title) + ylab(y_title) + theme_bw() + theme(legend.position = 'bottom') +
facet_grid(group ~ .)
# Tags per experiment condition
tags_city <- ggplot(tags_experiment, aes(group))
tags_city + geom_bar(stat = 'count') + geom_label(stat = 'count', aes(label=..count..), vjust=-.1)
